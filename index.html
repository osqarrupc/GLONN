---
layout: default
title: Graph-Based Lagrangian Neural Network for Optimal Power Flow
author: Óscar Cabrera Redondo & Sara Barja-Martinez & Mònica Aragüés-Peñalba
date: April 2025
abstract: The Optimal Power Flow problem is fundamental in electrical networks, aiming to determine optimal generation setpoints while satisfying network constraints. However, with the increasing penetration of renewable energy sources and power electronic devices, near real-time solutions are required and traditional optimization solvers struggle with fast performance, especially as system complexity increases. Recent machine learning approaches have improved computational efficiency, but often lack the ability to enforce physical and topological constraints, limiting their applicability in practical scenarios. This paper introduces GLONN, a novel neural architecture that integrates graph neural networks with Lagrangian principles to solve the OPF problem. GLONN leverages the grid's structural information via graph convolutions and enforces physical feasibility through a Lagrangian-based loss formulation, enabling both fast inference and constraint satisfaction. We evaluate GLONN on a set of benchmark electrical networks, comparing its performance against traditional solvers and baseline GNN models. Results show that GLONN achieves cost deviations of less than 4% from the global minimum while significantly reducing computation time. Furthermore, it consistently satisfies the electrical constraints inherent to the problem. These results underscore the potential of hybrid physics-informed and topology-aware neural networks for real-time power system optimization.
---
<p class="Section">1 &ensp; Introduction</p>
    <p class="BodyText2Col">Faster response times and more dynamic control strategies [1] are needed in the electrical grid due to the increasing penetration of renewable energy sources and power electronic devices. Optimal Power Flow (OPF), a fundamental tool that determines the most efficient generation dispatch in an electrical network ensuring efficiency and security, must be done faster. OPF has been a cornerstone of power system operation since its formalization in the early 1960s, where it emerged as a nonlinear optimization problem tailored to the electrical variables of the system [2]. </br>

    As future power grids increasingly incorporate various distributed energy sources, they introduce greater stochasticity and rapid fluctuations in the system [3]. In this context, computational efficiency becomes a key criterion for evaluating different OPF approaches. The execution time of these methods depends on several factors, including the number of buses, the choice of initial conditions, the formulation of the objective function, and the specific constraints of the problem [4].</br>

    However, conventional algorithms often fail to deliver fast and reliable solutions. To address these limitations, alternative methods have been explored, such as parallel computing techniques [1] and neural network-based models [4], which have demonstrated the potential to outperform traditional solvers in terms of computational speed. </br>

    This paper proposes a novel hybrid neural architecture that integrates Graph (GNN) and Lagrangian Neural Networks (LNN) to solve the OPF problem efficiently and robustly. The proposed approach, named GLONN, combines the structural learning power of GNNs with the interpretability and constraint-handling capabilities of Lagrangian methods. Unlike traditional data-driven approaches, the model requires no historical training data and generalizes well to unseen scenarios and system sizes.
    </p>

<p class="Section">2 &ensp; Methodology</p>
    <p class="BodyText">Optimal Power Flow: The Optimal Power Flow (OPF) can be seen as an evolution of Economic Dispatch where the physical conditions of the system are integrated in the problem. The main objective of the OPF problem is to minimize or maximize an objective function subject to a set of physical and operational constraints. Traditionally, the objective is to minimize generation costs, but alternative goals may include maximizing market surplus, minimizing transmission losses, or reducing environmental impact [5]. While OPF is primarily used as a day-ahead operational planning tool [6], it is increasingly required to be solved in much shorter timeframes—such as every five minutes within one minute, or even within 30 seconds for self-healing after contingencies [5]. The DC-OPF formula that tries to reduce the generation cost can be also consider as:
    \[
    \begin{aligned}
    \min \quad & f(\mathbf{P_{\mathrm{gen}}}) = \mathbf{P_{\mathrm{gen}}}^T \mathbf{c_2} \mathbf{P_{\mathrm{gen}}} + \mathbf{P_{\mathrm{gen}}}^T\mathbf{c_1} + \mathbf{c_0}^T \\[0.5em]
    \text{s.t.} \quad & \sum_{i \in B}P_{\mathrm{gen}_{i}}-\sum_{i \in B}P_{\mathrm{con}_i}-\sum_{\left(i,j\right) \in L}P_{ij}=0 \\[0.5em]
    & P_{\mathrm{gen}_i}^{\mathrm{min}} \leq P_{\mathrm{gen}_i} \leq P_{\mathrm{gen}_i}^{\mathrm{max}} \quad \forall i \in G \\[0.5em]
    & P_{ij} \leq S_{ij}^{\mathrm{max}} \quad \forall \left(i,j\right) \in L \\[0.5em]
    & -\theta_{ij}^\Delta \leq \theta_{i} - \theta_{j} \leq \theta_{ij}^\Delta \quad \forall i \in B
    \end{aligned}
    \]

    The idea is to find the minimum of this function based on the constraints that are imposed in the system. The objective function, creates a quadratic function subjected to different constraints. Let's imagine a surface where we need to find the minimum subject to some limits, as can be seen in the next figure. These limits create boundaries that constraints where the minimum can be found. In the next figure, a non-lineal objetive function can be found in gray color but the constraints (red planes) are lineal.
    </p>

    <div id="three-container" style="width: 80%; height: 300px; margin: 2rem auto"></div>

    <p class="BodyText2Col Justified">There are multiple iterative ways to find the minimum point using gradient calculations, such as the IPOPT solver does. The solution provided by solvers of a quadratic function will be always a global minimum as far as the constraints of the problem remain lineal. However, if the optimization problem consists of a quadratic linear function and non lineal constraints, the problem is non-convex and the solution given by a solver could be a local minimum and not a global minimum. In the electrical system, we use quadratic objective function as the typical electrical costs function for thermal power plants, but we need lineal constraints to be sure that the results given are global and not local minimas. The problem is that in the electrical network, most of the contraints are non-lineal. Therefore, a common practice is to approximate the problem with lineal constraints (DC-OPF) or to relax the problem through the quadratic convex (QC) or the second order (SOC) cone relaxation methods.
    </p>


<p class="SubSection">1.2 &ensp; What are we proposing? GLONN</p>
    <p class="BodyText2Col Justified">In this paper, we are approximating the results with the DC-OPF formulation and solving the problem using a GNN and LNN that applies the contraints of the electrical network. This neural network is called GLONN and in the next section, the results of the DC-OPF for different electrical networks can be found.
    </p>


<p class="Section">3 &ensp; Case Study and Results</p>
    <p class="BodyText Justified">This article implement the OPF on the <a href="https://github.com/power-grid-lib/pglib-opf" target="_blank">Power Grid Lib</a> using traditional and Neural Networks (NN) models.</p>
    <div class="BodyText">
      <label for="network-select">Choose a network:</label>
      <select id="network-select" onchange="updateDisplay()">
        <option value="">--Select a network--</option>
        <option value="pglib_opf_case3_lmbd">pglib_opf_case3_lmbd</option>
        <option value="pglib_opf_case3_lmbd__api">pglib_opf_case3_lmbd__api</option>
        <option value="pglib_opf_case3_lmbd__sad">pglib_opf_case3_lmbd__sad</option>
        <option value="pglib_opf_case14_ieee">pglib_opf_case14_ieee</option>
        <option value="pglib_opf_case14_ieee__api">pglib_opf_case14_ieee__api</option>
        <option value="pglib_opf_case162_ieee_dtc">pglib_opf_case162_ieee_dtc</option>
        <option value="pglib_opf_case162_ieee_dtc__api">pglib_opf_case162_ieee_dtc__api</option>
        <option value="pglib_opf_case162_ieee_dtc__sad">pglib_opf_case162_ieee_dtc__sad</option>
      </select>

    <label for="method-select" style="margin-left: 20px;">Choose a method:</label>
    <select id="method-select" onchange="updateDisplay()">
      <option value="">--Select a method--</option>
      <option value="IPOPT">IPOPT</option>
      <option value="GLONN">GLONN</option>
    </select>
    </div>

    <div id="graph-display" style="margin-top: 20px;"></div>

<p class="SubSection">3.1 &ensp; Table with results</p>
    <p class="BodyText2Col Justified">Next table depitcs the results of GLONN which are also compared against the IPOPT solver solutions. In <a href="https://github.com/power-grid-lib/pglib-opf" target="_blank">Power Grid Lib</a>, it is also possible to find a list of results for the DC-OPF solved with <a href="https://github.com/lanl-ansi/PowerModels.jl" target="_blank">PowerModels.jl</a>
    <table border="1" cellspacing="0" cellpadding="4">
    <caption>DC-OPF results for the different electrical networks</caption>
    <thead>
      <tr>
        <th>Electrical Network</th>
        <th>DC-OPF ($/h)</th>
        <th>GLONN ($/h)</th>
        <th>DC Time (sec.)</th>
        <th>GLONN Time (sec.)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>pglib_opf_case3_lmbd</td>
        <td>5693.80</td>
        <td>5652.66</td>
        <td>0.49</td>
        <td>0.02</td>
      </tr>
      <tr>
        <td>pglib_opf_case3_lmbd__api</td>
        <td>10432.00</td>
        <td>10314.75</td>
        <td>0.42</td>
        <td>0.00</td>
      </tr>
      <tr>
        <td>pglib_opf_case3_lmbd__sad</td>
        <td>5849.90</td>
        <td>5650.50</td>
        <td>0.40</td>
        <td>0.00</td>
      </tr>
      <tr>
        <td>pglib_opf_case14_ieee</td>
        <td>2051.50</td>
        <td>2037.80</td>
        <td>0.41</td>
        <td>0.00</td>
      </tr>
      <tr>
        <td>pglib_opf_case14_ieee__api</td>
        <td>4664.40</td>
        <td>4597.71</td>
        <td>0.39</td>
        <td>0.00</td>
      </tr>
      <tr>
        <td>pglib_opf_case162_ieee_dtc</td>
        <td>101270</td>
        <td>105661.95</td>
        <td>1.94</td>
        <td>0.00</td>
      </tr>
      <tr>
        <td>pglib_opf_case162_ieee_dtc__api</td>
        <td>111750</td>
        <td>115272.55</td>
        <td>0.46</td>
        <td>0.00</td>
      </tr>
      <tr>
        <td>pglib_opf_case162_ieee_dtc__sad</td>
        <td>103830</td>
        <td>105718.62</td>
        <td>0.59</td>
        <td>0.00</td>
      </tr>
    </tbody>
  </table>
  </p>



<p class="Section">5 &ensp; References</p>
    <p class="BodyText small">[1] ARAGÜÉS PEÑALBA, M., NGUYEN, T.L., CAIRE, R., SUMPER, A., GALCERAN ARELLANO, S. y TRAN, Q.-T., 2020. General form of consensus optimization for distributed OPF in HVAC-VSC-HVDC systems. , ISSN 0142-0615.</br>

    [2] HUNEAULT, M. y GALIANA, F.D., 1991. A survey of the optimal power flow literature. IEEE transactions on power systems, vol. 6, no. 2, ISSN 0885-8950. DOI 10.1109/59.76723.</br>

    [3] YUJIE TANG, DVIJOTHAM, K. y LOW, S., 2017. Real-Time Optimal Power Flow. IEEE transactions on smart grid, vol. 8, no. 6, ISSN 1949-3053. DOI 10.1109/TSG.2017.2704922.</br>

    [4] ABDI, H., BEIGVAND, S.D. y SCALA, M.L., 2017. A review of optimal power flow studies applied to smart grids and microgrids. Renewable & sustainable energy reviews, vol. 71, ISSN 1364-0321. DOI 10.1016/j.rser.2016.12.102.</br>

    [5] M. B. Cain, R. P. O’Neill, and A. Castillo, “History of Optimal Power Flow and Formulations,” 2012.</br>

    [6] CAPITANESCU, F., 2016. Critical review of recent advances and further developments needed in AC optimal power flow. Electric power systems research, vol. 136, ISSN 0378-7796. DOI 10.1016/j.epsr.2016.02.008.</p>



<script>
function showSelectedNetwork() {
  var select = document.getElementById("network-select");
  var output = document.getElementById("network-info");

  // Mapeo de opciones con sus rutas de archivo
  var networkMap = {
    "network1": "./assets/graphs/pglib_opf_case3_lmbd.html",
    "network2": "./assets/graphs/pglib_opf_case3_lmbd__api.html",
    "network3": "./assets/graphs/pglib_opf_case3_lmbd__sad.html",
    "network4": "./assets/graphs/pglib_opf_case14_ieee.html",
    "network5": "./assets/graphs/pglib_opf_case14_ieee__api.html",
    "network6": "./assets/graphs/pglib_opf_case162_ieee_dtc.html",
    "network7": "./assets/graphs/pglib_opf_case162_ieee_dtc__api.html",
    "network8": "./assets/graphs/pglib_opf_case162_ieee_dtc__sad.html"
  };

  var selectedValue = select.value;

  if (networkMap[selectedValue]) {
    output.innerHTML = '<iframe src="' + networkMap[selectedValue] + '" width="100%" height="600" frameborder="0"></iframe>';
  } else {
    output.innerHTML = "";
  }
}
function updateDisplay() {
  const network = document.getElementById("network-select").value;
  const method = document.getElementById("method-select").value;
  const output = document.getElementById("graph-display");

  if (network && method) {
    const filename = `${network}_${method}.html`; // Ej: IEEE14_GLONN.html
    const path = `./assets/graphs/${filename}`;
    output.innerHTML = `<iframe src="${path}" width="100%" height="600" frameborder="0"></iframe>`;
  } else {
    output.innerHTML = ""; // Limpia si falta algo
  }
}
</script>